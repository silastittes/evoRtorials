---
title: "Week 3 -- Visualize Sunflower Data"
author: "Silas Tittes"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document:
    fig_caption: yes
---

Quantifying and visualizing potential fitness
=============================================

Last week each individual in class collected data on the geographic location, 
size (diameter at a height of 12''), and estimated number of seeds for individual 
sunflower plants. Stem diameter is a measure of plant size. The estimated number 
of seeds per individual is a measure of the potential fitness of a plant. 

This week your job is to construct a data set that combines all the data from 
all individuals (in EXCEL) and uses the data to visualize the variation 
in a population. 

The compiled data from each lab section are available on D2L. 

Goal summary
-----------

\begin{center}
    \begin{tabular}{ | p{5.3cm} | p{5.3cm} | p{5.3cm} |}
    \hline
    \bf{What you should be able to do} & \bf{How it will be achieved } & 
    \bf{Questions to answer} \\
    \hline
    Assemble a large data set without error & 
    Combine several small spreadsheet into one large spreadsheet using EXCEL &
    \phantom{text} \\
    \hline
    Show the geographic distribution of the potential fitness of individuals &
    Make a map of the plants with circle size proportional to log(\# seeds) 
    using R &
    Is there any pattern to the geographic distribution of variation? 
    Explain you answer. \\
    \hline
    Compare diameter at 12'' with estimated number of seeds for 
    all plants (bivariate plot) &
    Construct a script in R &
    What is the association between the diameter of the stems and the 
    estimated number of seeds? \\
    \hline
    Compare two histograms for number of seeds per plant: one the 
    untransformed data and one with the data log-transformed &
    Construct a script in R &
    What is different about the two ways of summarizing the data? \\
    \hline
    Use the mean number of seeds per plant as an estimate of the intrinsic rate 
    of increase and, assuming the number of plants observed this year estimates
    population size, estimate the population size next year 
    (assume all seeds survive) &
    Construct a script in R &
    What is the expected number of plants next year if all seeds survive? \\
    \hline
    Assume that population size next year is the same as this year and 
    calculate the proportion of the total estimated reproductive effort of the 
    population that will ultimately die (fail to germinate and grow) &
    Construct a script in R & 
    Does the estimate of the fraction of seeds that will probably perish 
    indicate that there is a struggle for existence? Why or why not? \\
    \hline
    Use one of the graphs you made a make a claim based on the evidence 
    in the graph &
    Practice scientific thinking &
    \phantom{text} \\
    \hline
    \end{tabular}
\end{center}


`R` Code
========

Question 1
----------
Use the following code block to load the full sunflower data set and *answer the 
question directly below the code block.*
NOTE: You *CANNOT* load the file using `file.choose()` function. Your document
will not knit if you try. Instead uou *must* save this file in the same place 
as the data set, or use `setwd()` to direct `R` to the location of the 
data file.

```{r} 
#load in the sunflower data
flowers <- read.csv("all_sunflowerv2.csv")

#look at the structure of the data file
str(flowers)
```


Question 2
----------
Use the following code block to show the geographic distribution of the 
potential fitness of individuals by making a map of the plants with 
circle size proportional to log10(\# flower heads). 
*Hint:* you'll need to add cex=<value> in your call to `plot()` 

`r #edit the text in quotes below to change your plot caption`
`r captext1 <- "Geographic distribution of sunflowers with point size scaled to the log10 of the number of flowers"`
```{r, fig.align='center', fig.cap=captext1}
#plot the data in a space defined by latitude and longitude and make point size proportional to the log10 of number of flower heads
plot(flowers$longitude, flowers$latitude, cex=log10(flowers$heads), ylim=c(39.5,40.1), xlim=c(-105.3,-105.1), ylab="Latitude", xlab="Longtitude")

```
Is there any pattern to the geographic distribution of variation? 
Explain you answer.

*There are points of different sizes scattered across the landscape suggesting there is no apparent pattern to where plants with the largest and smallest numbers of flower heads. Instead, at every site there appears to be plants that vary in the number of flower heads*



Question 3
----------
Use the following code block to compare diameter at 12'' with 
estimated number of seeds for all plants (bivariate plot) 

`r #edit the text in quotes below to change your plot caption`
`r captext2 <- "Association between size of plant estimated by the circumference of the plant's stalk and the number of flower heads"`

```{r, fig.align='center', fig.cap=captext2}
#visualize the association between size of plant and number of flower heads
plot(flowers$base, flowers$heads, xlab="Circumference of plant stalk (mm)", ylab="Number of flower heads")

```

What is the association between the diameter of the stems and the 
estimated number of seeds?

*There is a tremendous scatter of points but overall there appears to be an increase in number of flower heads with an increase in the size of the plant*




Question 4
----------
Compare two histograms: one with the data for the number of flower heads and one for the logarithmic of the number of flower heads. 

`r captext3 <- "Distribution of number of flower heads per plant"`

```{r, fig.align='center', fig.cap=captext3}

#construct a histogram of the number of flower heads per plant
hist(flowers$heads, breaks=seq(0,150,5), ylab="Number of plants", xlab="Number of flower heads per plant", col="yellow", main="Histogram of number of flower heads per plant")
abline(v=mean(flowers$heads,na.rm=T),lwd=3, lty=3, col="blue")
```
`r captext5 <- "Distribution of log of the number of flower heads per plant"`

```{r, fig.align='center', fig.cap=captext5}

#visualize the association between size of plant and number of flower heads
hist(log(flowers$heads), ylab="Number of plants", xlab="log(Number of flower heads per plant)", col="yellow", main="Histogram of log(flower heads)")
abline(v=mean(log(flowers$heads),na.rm=T),lwd=3, lty=3, col="blue")


```

How do the two distributions differ?

*For the untransformed (raw) data, there is a pronounced right skew to the data (see figure 4)  whereas the log transformed data looks more symmetric and lacks the pronounced right skew (see figure 5). My assessments of symmetry are based on how much of the x-axis is to the left and right of the mean indicated by the vertical dash lines*


Question 5
----------

What is the expected number of plants in the next generation, assuming the number of plants observed this year estimates population size and the total number of seeds for all plants estimates the number of plants in the next generation?  

```{r}
#first we need to make a vector of the number of seeds per plant assuming that the number of seeds in a single flower head estimates the number in each of the flower heads on the plant
tot_seeds_plant <- flowers$heads*flowers$seeds

#number of plants next year if all seeds survive
pop_size_next_year <- sum(tot_seeds_plant,na.rm=T)

```

*The expected number of plants next year is `r pop_size_next_year` if all seeds survive*


Question 6
----------
Assume that population size next year is the same as this year and 
calculate the proportion of the total estimated reproductive effort of the 
population that will ultimately die (fail to germinate and grow)

```{r}
#first we need to know how many plants there were this year 
total_plants <- length(flowers$heads)

#the one that die is the difference in the total number of seeds - the population size this year
num_die <- pop_size_next_year - total_plants

#the proportion of plants that die is just the number that die divided by the total that should exist if all seeds survive
prop_die <- num_die/pop_size_next_year
```

*Based on the data, approximately 99.97% of the seeds produced will not survive to maturity.*

Question 7
----------
Use one of the graphs you made a make a claim based on the evidence 
in the graph
Practice scientific thinking 

*I am most interested in the variation in the number of flower heads per plant at each locality. It appears that all localities have individuals that have very few flower heads per plant and some individuals with many flower heads per plant suggesting that at all localities that is a lot of variation in potential fitness among plants.*

Finally, answer the following questions:

Q1. What are examples of environmental effects that you think affect the sunflower traits measured? 

*Amount of soil moisture, nutrient levels, and plant density*

Q2. Do you think the differences among individuals are due mostly to genetic or environmental effects? Why or why not? 

*I think that most of the differences are due to environmental effects in part because I witnessed that there were very large plants in areas where you can imagine there was more water and much small plants where it looked like there may be limited water.*

Q3. There is clear evidence from your data that some individuals are more fit (have greater potential reproductive success) than other individuals. To what extent do you think the observed differences are due to chance? Justify your answer. 

*It may be chance just because of where seeds were when they germinated. If they were in sites with more water, they were larger and had more flower heads than plants that germinated and grew in drier sites.*


Checklist
=========

$\square$ Assembled data set (1 pt)

$\square$ Visualizations of size and number of seeds per plant (1 pt)

$\square$ Visualization of geographic distribution of number of seeds per plant (1 pt)

$\square$ Bivariate plot of height and number of seeds (1 pt)

$\square$ Pair of histograms showing untransformed and log-transformed data (1 pt)

$\square$ Calculation of Nt+1 (1 pt)

$\square$ Calculation of proportion of seeds that do not make it if Nt+1 = Nt (1 pt)

$\square$ Answers to the 9 questions (9 pts)

$\square$ Make a claim and support claim with evidence (4 pts)


20 points total